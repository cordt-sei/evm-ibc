"use strict";(self.webpackChunkibc_transfer_ui=self.webpackChunkibc_transfer_ui||[]).push([[5335],{32708:(e,n,t)=>{t.d(n,{n:()=>l});var r=t(29109),o=t(96540),i=t(80066);const l=(e,n={})=>{const[t,l]=(0,o.useState)({isLoading:!1}),a=(0,o.useCallback)((t=>(0,r.s)(void 0,void 0,void 0,(function*(){var r,o;let a;l({isLoading:!0});try{const o=e(t);a=o instanceof Promise?yield o:o,l({data:a,isLoading:!1});try{null===(r=null==n?void 0:n.onSuccess)||void 0===r||r.call(n,a,t)}catch(e){i.vF.error(e)}return a}catch(e){l({error:e,isLoading:!1}),i.vF.error(e);try{null===(o=null==n?void 0:n.onFailure)||void 0===o||o.call(n,e,t)}catch(e){i.vF.error(e)}}}))),[e,n]);return Object.assign(Object.assign({},t),{hasData:Boolean(t.data),hasError:Boolean(t.error),mutate:a})}},10528:(e,n,t)=>{t.d(n,{r:()=>o});var r=t(96540);const o=({projectSettings:e,cosmosNetworkOverrides:n,evmNetworksOverrides:t})=>(0,r.useMemo)((()=>{var r,o,a,s,d;const c=null==e?void 0:e.networks;if(!c)return{};const u=c.find((e=>"evm"===e.chainName)),v=c.find((e=>"solana"===e.chainName)),h=c.find((e=>"cosmos"===e.chainName)),f=c.find((e=>"starknet"===e.chainName)),m=c.find((e=>"eclipse"===e.chainName));let y=null===(r=null==h?void 0:h.networks)||void 0===r?void 0:r.map((e=>i(e,parseInt)));y=l(n,y);let g=null===(o=null==u?void 0:u.networks)||void 0===o?void 0:o.map((e=>i(e,parseInt)));g=l(t,g);const p=null===(a=null==f?void 0:f.networks)||void 0===a?void 0:a.map((e=>i(e))),k=null===(s=null==v?void 0:v.networks)||void 0===s?void 0:s.map((e=>i(e))),C=null===(d=null==m?void 0:m.networks)||void 0===d?void 0:d.map((e=>i(e)));return t&&(g=Array.isArray(t)?t:t(null!=g?g:[])),{cosmos:y,eclipse:C,evm:g,solana:k,starknet:p}}),[null==e?void 0:e.networks,n,t]),i=(e,n=e=>e)=>({bech32Prefix:e.bech32Prefix,blockExplorerUrls:e.blockExplorerUrls,chainId:n(e.chainId),iconUrls:e.iconUrls,lcdUrl:e.lcdUrl,name:e.name,nativeCurrency:e.nativeCurrency,networkId:n(e.networkId),privateCustomerRpcUrls:e.privateCustomerRpcUrls,rpcUrls:e.rpcUrls,vanityName:e.vanityName}),l=(e,n)=>e?Array.isArray(e)?e:e(null!=n?n:[]):n},2742:(e,n,t)=>{t.d(n,{$:()=>i});var r=t(80426),o=(t(96540),t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const i=e=>{var n,t;const{data:i}=(0,r.v)((()=>null==e?void 0:e.connector.getNetwork()),{enabled:Boolean(e)}),{networkConfigurations:l}=(0,o.J)();if(e&&i)return"SOL"===e.chain?null===(n=null==l?void 0:l.solana)||void 0===n?void 0:n[0]:null===(t=null==l?void 0:l[e.connector.connectedChain.toLowerCase()])||void 0===t?void 0:t.find((e=>e.chainId===i))}},74070:(e,n,t)=>{t.d(n,{p:()=>a}),t(96540),t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109);var r=t(71571),o=(t(60337),t(21029),t(47979),t(63055),t(45468),t(4402),t(11011),t(40337),t(22671)),i=(t(81285),t(20433),t(83073),t(99157),t(7116),t(54769),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(20176)),l=(t(80622),t(31825),t(89809));const a=()=>{const{selectedWalletConnector:e,setShowAuthFlow:n,bridgeChainsToConnect:t,bridgeOnboardingCompleted:a,isBridgeFlow:s,user:d,authMode:c}=(0,l.J)(),u=(0,r.s)({shouldCallCallback:!1,shouldUpdateWallets:Boolean(null==t?void 0:t.length)}),{network:v}=(0,i.g)(e,{onChange:r=>{e&&(0,o.l)({network:r,walletConnector:e})&&u({walletConnector:e}).then((()=>{(d||"connect-and-sign"!==c)&&(s&&!a&&(null==t?void 0:t.length)||n(!1))}))}});return{currentNetwork:v}}},65042:(e,n,t)=>{t.d(n,{X:()=>o});var r=t(96540);const o=e=>{const n=(0,r.useRef)(e);n.current=e,(0,r.useEffect)((()=>{const e=new Date;return()=>{(new Date).getTime()-e.getTime()<10||n.current()}}),[])}},55616:(e,n,t)=>{t.d(n,{_:()=>o}),t(96540),t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825);var r=t(89809);const o=()=>{const{authMode:e,user:n}=(0,r.J)();return"connect-only"===e&&!n}},32482:(e,n,t)=>{t.d(n,{V:()=>A});var r=t(29109),o=t(96540),i=t(46759),l=t(80066),a=(t(83650),t(69648)),s=(t(88393),t(74848),t(41253)),d=(t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174)),c=(t(54769),t(60337),t(83219)),u=(t(4402),t(11011),t(40337),t(30325)),v=(t(81285),t(24721)),h=(t(45468),t(99157),t(7116),t(18003)),f=t(23713),m=t(98067),y=(t(20433),t(83073),t(21029),t(47979),t(63055),t(28765)),g=(t(40961),t(74456)),p=(t(20545),t(50574),t(75988)),k=(t(451),t(55229)),C=t(10741),b=t(5332),w=t(5678),E=(t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const A=()=>{var e,n,t;const{environmentId:A,primaryWallet:I,projectSettings:R,setShowAuthFlow:F,user:S}=(0,E.J)(),{createRootElement:N}=(0,g.k)(),O=N(k.b),{isTurnkeyWalletWithoutAuthenticator:T,hasRecoveryEmail:P}=(0,w.b)(),{initAuthMethod:_}=(0,b.g)(),{setDisplayedDestination:U,setVerificationUUID:W}=(0,y.vm)(),{getEOAWallet:D}=(0,p.R)(),{setView:L}=(0,s.At)(),M=null!==(e=I&&D(I))&&void 0!==e?e:I,j=(0,o.useCallback)((()=>(0,r.s)(void 0,void 0,void 0,(function*(){var e,n;if(!(null===(e=null==R?void 0:R.sdk.embeddedWallets)||void 0===e?void 0:e.sessionKeyDuration)||!(0,C.c6)(null===(n=null==R?void 0:R.sdk.embeddedWallets)||void 0===n?void 0:n.sessionKeyDuration))return!1;const t=(0,m.F)(R.sdk.embeddedWallets.sessionKeyDuration);try{return yield(0,C.SR)({iframeContainer:O.current,iframeElementId:k.M,sessionExpiration:t,user:S,wallet:I})}catch(e){a.v.error("Failed to restore embedded wallet",e)}return!1}))),[S,O,I,null===(t=null===(n=null==R?void 0:R.sdk)||void 0===n?void 0:n.embeddedWallets)||void 0===t?void 0:t.sessionKeyDuration]),V=(0,o.useCallback)((()=>(0,r.s)(void 0,void 0,void 0,(function*(){if(!M||!(0,l.NO)(M.connector))return!1;const e=M.connector.getAuthenticatorHandler();return!(!T||e.isSessionActive()||(yield j()))}))),[M,T,j]),B=(0,o.useCallback)(((e,n)=>(0,r.s)(void 0,void 0,void 0,(function*(){var t;(()=>{if(!S)throw new Error(c.nM);if(!(0,u.A)(R))throw new Error("Dynamic embedded wallet is not enabled. Go to the dashboard and make sure to have both Dynamic embedded wallet and at least one EVM network enabled. Also, check if EthereumWalletConnectors is in the  DynamicContextProvider > settings > walletConnectors.");if(!(0,f.C)(S))throw new Error("Dynamic embedded wallet not found");if(M&&!(0,l.NO)(M.connector))throw new Error("Dynamic embedded wallet not found.")})();const r=(null==M?void 0:M.connector).getAuthenticatorHandler();if("passkey"===e&&r.isSessionActive())return yield(0,C.jX)({environmentId:A,user:S,wallet:M}),F(!1),M;const o=(0,v.a)(null===(t=null==R?void 0:R.sdk.embeddedWallets)||void 0===t?void 0:t.supportedSecurityMethods),i=o?Object.keys(o):[];if(P)if(!e&&i.length>1)L("embedded-wallet-auth-choice",{currentAction:n}),F(!0,{ignoreIfIsEmbeddedWidget:!1,performMultiWalletChecks:!1});else{const[t]=i;e&&!i.includes(e)&&(e=t),yield _({authenticatorType:e||t,currentAction:n,iframeContainer:O.current})}else L("passkey-recovery-add-email",{shouldInitRecovery:!0}),F(!0,{ignoreIfIsEmbeddedWidget:!1,performMultiWalletChecks:!1});return new Promise(((e,n)=>{d.zm.once("passkeyRecoveryCompleted",(n=>e(n))),d.zm.once("passkeyRecoveryFailed",(e=>n(e)))}))}))),[M,R,P,A,S,F,L,_,O]);return{addRecoveryEmail:e=>(0,r.s)(void 0,void 0,void 0,(function*(){try{let n=S;(null==S?void 0:S.email)||(n=yield(e=>(0,r.s)(void 0,void 0,void 0,(function*(){try{const{nextView:n,emailVerification:t,userProfile:r}=yield(0,h.zz)(A,{email:e});return n===i.YhY.Done?r:(L("verify-email",{isEmailRecoveryFlow:!0}),U(e),W(null==t?void 0:t.verificationUUID),new Promise(((e,n)=>{d.zm.once("emailVerificationResult",(t=>{t&&e(r),n("Failed to verify email")}))})))}catch(e){throw a.v.error("Failed to update user email",e),e}})))(e)),yield(0,C.n6)({environmentId:A,user:n,wallet:I}),d.zm.emit("embeddedWalletRecoveryEmailCompleted","")}catch(e){a.v.error("Failed to add recovery email",e),d.zm.emit("embeddedWalletRecoveryEmailFailed",e)}})),initPasskeyRecoveryProcess:B,shouldInitRecovery:V}}},3464:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(96540);const o=e=>{const n=(0,r.useRef)();return(0,r.useEffect)((()=>{n.current=e}),[e]),n.current}},80426:(e,n,t)=>{t.d(n,{v:()=>l});var r=t(29109),o=t(96540),i=t(69648);const l=(e,n)=>{const t=(0,o.useRef)((new Date).getTime()),{deps:l=[],initialData:a,enabled:s=!0,retries:d=0}=n||{},c=(0,o.useRef)({onBeforeFetch:null==n?void 0:n.onBeforeFetch,onReject:null==n?void 0:n.onReject,onResolve:null==n?void 0:n.onResolve});c.current={onBeforeFetch:null==n?void 0:n.onBeforeFetch,onReject:null==n?void 0:n.onReject,onResolve:null==n?void 0:n.onResolve};const[u,v]=(0,o.useState)(a),[h,f]=(0,o.useState)(s),[m,y]=(0,o.useState)(void 0),g=(0,o.useCallback)((()=>(0,r.s)(void 0,void 0,void 0,(function*(){var n,o;const a=(new Date).getTime();return a-t.current<5&&i.v.logVerboseTroubleshootingMessage("usePromise: Fetcher function was called in very quick succession. Please make sure the fetcher function is not synchronous and that you are not calling it inside a loop.",l),t.current=a,f(!0),null===(o=(n=c.current).onBeforeFetch)||void 0===o||o.call(n),((e,n)=>(0,r.s)(void 0,[e,n,(e,n)=>{var r,o,l,s;if(a===t.current){if(e)return i.v.error(e),y(e),void(null===(o=(r=c.current).onReject)||void 0===o||o.call(r,e));v(n),null===(s=(l=c.current).onResolve)||void 0===s||s.call(l,n)}}],void 0,(function*(e,{retries:n},t){const r=n?n+1:1;let o,i,l=0;for(;l<r;){l+=1;try{const n=e();if(o=n instanceof Promise?yield n:n,i=void 0,o)break}catch(e){i=e}}return t(i,o),o})))(e,{retries:d}).finally((()=>f(!1)))}))),l);return(0,o.useEffect)((()=>{s&&g()}),[g,s]),(0,o.useMemo)((()=>({data:u,error:m,isLoading:h,retrigger:g})),[u,m,h,g])}},34928:(e,n,t)=>{t(96540),t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(18003),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809)},16902:(e,n,t)=>{t.d(n,{F:()=>f});var r=t(29109),o=t(96540),i=t(46759),l=t(69648),a=(t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(4402),t(11011),t(40337),t(69793)),s=(t(45468),t(99157)),d=t(81285),c=(t(7116),t(18003)),u=t(81149),v=t(3194),h=t(20433);const f=()=>{const[e,n]=(0,o.useState)(!0),t=(0,o.useRef)(!1),f=(0,s.wz)(),m=(0,h.S2)(),y=(0,d.KK)(),g=(0,o.useRef)(!1);return(0,v.h)("logout",(()=>g.current=!0)),(0,o.useEffect)((()=>{t.current||(0,r.s)(void 0,void 0,void 0,(function*(){if(!f&&(0,a.M)()&&!g.current){t.current=!0;try{const e=yield(0,c.e4)({environmentId:m}),n=null==e?void 0:e.verifiedCredentials.find((n=>n.format===i.z3W.Blockchain&&n.id===e.lastVerifiedCredentialId));n&&(0,u.q)(n.id)}catch(e){l.v.debug("Ignore failed refreshUserJwt in useResetCookieLocalStorage")}}y&&n(!1)}))}),[f,y,m]),{isLoading:e}}},15320:(e,n,t)=>{t.d(n,{w:()=>o});var r=t(96540);const o=(e,n)=>{const[t,o]=(0,r.useState)(),i=(0,r.useCallback)((e=>{if(!Array.isArray(e))return;const[t]=e;o(t.contentRect),n&&n(t.contentRect)}),[n,o]);return(0,r.useLayoutEffect)((()=>{if(!e.current)return;let n=new ResizeObserver(i);return n.observe(e.current),()=>{null==n||n.disconnect(),n=null}}),[e]),[t]}},17696:(e,n,t)=>{t(96540),t(75705),t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809)},57632:(e,n,t)=>{t.d(n,{T:()=>s});var r=t(96540),o=(t(46759),t(69648)),i=(t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(15988)),l=(t(10941),t(16219),t(29109),t(45468),t(4402),t(11011),t(40337),t(81285),t(27953)),a=(t(20433),t(83073),t(99157),t(38399));t(7116);const s=({settings:e,environmentId:n})=>{(0,i.S)((()=>{const t={settings:Object.assign(Object.assign({},e),{customPrivacyPolicy:Boolean(e.customPrivacyPolicy),customTermsOfServices:Boolean(e.customTermsOfServices),policiesConsentInnerComponent:Boolean(e.policiesConsentInnerComponent)})},r=d(e.events),o=(0,l.w)(e.walletConnectors),i=Object.assign(Object.assign({},t),{settings:Object.assign(Object.assign({},t.settings),{events:r,walletConnectors:o})});(0,a.C)(n,{dynamicContextProps:i,frameworkSettings:c()})}))},d=e=>{try{if(!e)return;const n=Object.values(e);return Object.keys(e).filter(((e,t)=>void 0!==n[t]&&e))}catch(e){return void o.v.error("error serializing events",e)}},c=()=>{var e;return{nextJs:{version:null===(e=window.next)||void 0===e?void 0:e.version},react:{version:r.version}}}},36312:(e,n,t)=>{t.d(n,{K:()=>l});var r=t(80066),o=(t(46759),t(48702),t(60445),t(29109),t(4402),t(69648),t(3418),t(11011),t(88393),t(96540),t(74848),t(41253),t(95821),t(10941),t(16219),t(40337),t(81285),t(40609)),i=(t(45468),t(99157),t(7116),t(20433),t(83073),t(12174),t(83650),t(54769),t(60337),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(30447));t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825);const l=(e,n,t)=>{const{registerEmbeddedWalletSessionKey:l,removeSessionKey:a}=(0,i.t)({environmentId:n,projectSettings:t});if(!(null==e?void 0:e.length))return;const{fetchAuthToken:s,fetchBackupCode:d,fetchPasscode:c}=(0,o.C)({environmentId:n});e.forEach((e=>{var n,t;(0,r.hz)(e.walletConnector)&&(e.walletConnector.setAuthTokenFetcher(s),e.walletConnector.setBackupCodeFetcher(d),e.walletConnector.setPasscodeFetcher(c)),(0,r.SE)(e.walletConnector)&&(null===(n=e.walletConnector)||void 0===n||n.setSessionKeyFetcher(l),null===(t=e.walletConnector)||void 0===t||t.setSessionKeyRemoveFunction((()=>a())))}))}},75512:(e,n,t)=>{t.d(n,{a:()=>r});const r=(e,n)=>{e&&(null==n?void 0:n.length)&&n.forEach((n=>{n.walletConnector.setVerifiedCredentials(e.verifiedCredentials)}))}},75988:(e,n,t)=>{t.d(n,{R:()=>a});var r=t(96540),o=t(46759),i=(t(83650),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(41701)),l=(t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const a=()=>{const{user:e,walletConnectorOptions:n}=(0,l.J)(),t=(0,r.useCallback)((n=>{const{verifiedCredentials:t}=null!=e?e:{};if(!t)return;const r=t.find((e=>e.id===n.id));return(null==r?void 0:r.walletProvider)===o.EDz.SmartContractWallet?r:void 0}),[e]),a=(0,r.useCallback)((r=>{var o,l,a;const s=null==e?void 0:e.verifiedCredentials;if(!s)return;const d=t(r),c=s.find((e=>e.id===(null==d?void 0:d.signerRefId)));if(!(null==c?void 0:c.address)||!(null==c?void 0:c.chain))return;const{walletConnector:u}=null!==(o=(0,i.T)(c,n))&&void 0!==o?o:{},v=!(null===(l=c.walletName)||void 0===l?void 0:l.startsWith("turnkey"))||Boolean(null===(a=c.walletProperties)||void 0===a?void 0:a.isAuthenticatorAttached);return null==u?void 0:u.createWallet({address:c.address,chain:u.connectedChain,connector:u,id:c.id,isAuthenticated:v,key:u.key})}),[t,null==e?void 0:e.verifiedCredentials,n]),s=(0,r.useCallback)((t=>{var r;const o=null==e?void 0:e.verifiedCredentials;if(!o)return;const l=o.find((e=>e.id===t.id)),a=o.find((e=>e.signerRefId===(null==l?void 0:l.id)));if(!(null==a?void 0:a.address)||!(null==a?void 0:a.chain))return;const{walletConnector:s}=null!==(r=(0,i.T)(a,n))&&void 0!==r?r:{};return null==s?void 0:s.createWallet({address:a.address,chain:s.connectedChain,connector:s,id:a.id,isAuthenticated:!0,key:s.key})}),[null==e?void 0:e.verifiedCredentials,n]);return(0,r.useMemo)((()=>({getEOAWallet:a,getSmartWallet:s,isSmartWallet:e=>void 0!==t(e)})),[a,t,s])}},24204:(e,n,t)=>{t.d(n,{$:()=>f});var r=t(29109),o=t(96540),i=t(30593),l=(t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253)),a=(t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(54769),t(60337),t(4402),t(11011),t(90029)),s=t(62065),d=(t(40337),t(76529)),c=(t(81285),t(45468),t(99157),t(279)),u=(t(7116),t(20433),t(83073)),v=(t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(65050)),h=(t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(87237),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(7085),t(78080),t(80607),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const f=()=>{var e;const{environmentId:n,user:t,projectSettings:f}=(0,h.J)(),{setView:m}=(0,l.At)(),{handleError:y,setError:g,setIsProcessing:p,checkValidProvider:k,error:C,isProcessing:b,connectSocialAccount:w}=(0,v.f)({onFarcasterUrl:e=>m("farcaster-connect-view",{url:e})}),E=(0,o.useMemo)((()=>{var e,n;const r=null!==(n=null===(e=null==t?void 0:t.verifiedCredentials)||void 0===e?void 0:e.filter((e=>"oauth"===e.format)))&&void 0!==n?n:[];return Object.fromEntries(new Map(r.map((e=>{var n;return[null!==(n=e.oauthProvider)&&void 0!==n?n:e.id,e]}))))}),[null==t?void 0:t.verifiedCredentials]),A=(0,o.useCallback)((e=>(0,d.Y)(f)?E[e]?(y(e,i._m.ACCOUNT_ALREADY_LINKED,`Account already linked for provider: ${e}`,{raiseAuthFailure:!1}),!1):!!(0,a.j)(null==f?void 0:f.providers).find((n=>n.provider===e))||(y(e,i._m.PROVIDER_NOT_ENABLED,`Social linking provider is not enabled in Information Capture on the dashboard: ${e}`,{raiseAuthFailure:!1}),!1):(y(e,i._m.SOCIAL_LINKING_NOT_ENABLED,"Social linking is not enabled in Information Capture on the dashboard",{raiseAuthFailure:!1}),!1)),[y,f,E]),I=(0,o.useCallback)(((e,...n)=>(0,r.s)(void 0,[e,...n],void 0,(function*(e,{redirectUrl:n}={redirectUrl:void 0}){w({authMode:"link",provider:e,redirectUrl:n,validator:A})}))),[A,w]),R=(0,o.useCallback)((e=>(0,r.s)(void 0,void 0,void 0,(function*(){var t;if(g(void 0),p(!0),!k(e,"unlink"))return;const r=E[e];if(r)try{const o=(0,u.r6)();if(!(yield(0,c.x6)({environmentId:n,primaryWalletId:o,verifiedCrentialId:null!==(t=r.id)&&void 0!==t?t:""})))return void y(e,i._m.UNLINK_ERROR,`Failed to unlink social account: ${e} | ${r.id}`,{raiseAuthFailure:!1});p(!1)}catch(n){y(e,i._m.GENERAL_ERROR,`Failed to unlink social account: ${e} | ${r.id}`,{raiseAuthFailure:!1})}else y(e,i._m.NO_ACCOUNT_LINKED,`No account linked for provider: ${e}`,{raiseAuthFailure:!1})}))),[k,n,y,g,p,E]),F=(0,o.useCallback)((e=>Boolean(E[e])),[E]),S=(0,o.useCallback)((e=>{const n=E[e];if(!n)return;const{id:t,oauthAccountId:r,oauthAccountPhotos:o,oauthDisplayName:i,oauthEmails:l,oauthProvider:a,oauthUsername:s,publicIdentifier:d}=n;return{accountId:null!=r?r:void 0,avatar:null==o?void 0:o[0],displayName:null!=i?i:void 0,email:null==l?void 0:l[0],id:t,provider:a,publicIdentifier:d,username:s}}),[E]),N=(0,o.useCallback)((e=>{var n;return!!(0,s.B)(null===(n=null==f?void 0:f.sdk.socialSignIn)||void 0===n?void 0:n.providers).find((n=>n===e))||(y(e,i._m.PROVIDER_NOT_ENABLED,`Provider is not enabled for sign-in on the dashboard: ${e}`,{raiseAuthFailure:!0}),!1)}),[y,null===(e=null==f?void 0:f.sdk.socialSignIn)||void 0===e?void 0:e.providers]),O=(0,o.useCallback)(((e,...n)=>(0,r.s)(void 0,[e,...n],void 0,(function*(e,{redirectUrl:n}={redirectUrl:void 0}){return w({authMode:"signin",provider:e,redirectUrl:n,validator:N})}))),[N,w]);return(0,o.useMemo)((()=>({error:C,getLinkedAccountInformation:S,isLinked:F,isProcessing:b,linkSocialAccount:I,signInWithSocialAccount:O,unlinkSocialAccount:R})),[C,S,F,b,I,O,R])}},65050:(e,n,t)=>{t.d(n,{f:()=>I});var r=t(29109),o=t(96540),i=t(46759),l=t(30593),a=t(60445),s=(t(83650),t(69648)),d=(t(88393),t(80066),t(74848),t(41253),t(95821),t(3418),t(48702),t(10941),t(16219),t(12174)),c=(t(54769),t(60337)),u=t(87617),v=t(83393),h=(t(4402),t(11011),t(43257)),f=t(63241),m=t(65913),y=t(40337),g=t(60867),p=(t(81285),t(45468),t(99157),t(279)),k=(t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(30447)),C=(t(50574),t(451),t(68248));const b=e=>(0,r.s)(void 0,void 0,void 0,(function*(){try{const n=yield a.M6.fetch("https://relay.farcaster.xyz/v1/channel/status",{headers:{Authorization:`Bearer ${e.channelToken}`,"Content-Type":"application/json"},method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return yield n.json()}catch(e){return void s.v.error("Error fetching farcaster connect status:",e)}}));t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(87237),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(7085),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(80607),t(18983),t(21858),t(80622),t(31825);var w=t(89809);const E=["apple","coinbasesocial","discord","epicgames","facebook","farcaster","github","google","instagram","line","shopify","spotify","tiktok","telegram","twitch","twitter"],A=["twitter","github"],I=({onSettled:e,onError:n,onFarcasterUrl:t})=>{const{environmentId:I,setShowAuthFlow:F,socialSettings:S,projectSettings:N,redirectUrl:O}=(0,w.J)(),T=(0,o.useMemo)((()=>(null==S?void 0:S.strategy)||"redirect"),[S]),{setErrorMessage:P,setError:_}=(0,c.pu)(),{initAuth:U}=(0,C.r)({authMethod:"social"}),{generateSessionKey:W,shouldRegisterSessionKeysOnSignin:D}=(0,k.t)({environmentId:I,projectSettings:N}),[L,M]=(0,o.useState)(!1),[j,V]=(0,o.useState)(),B=(0,o.useCallback)((()=>{V(void 0),_(void 0)}),[_]),K=(0,o.useCallback)(((t,r,o)=>{M(!1),null==n||n(),null==e||e(),t&&(null==o?void 0:o.raiseAuthFailure)&&d.zm.emit("authFailure",{option:t,provider:t,type:"social"},r)}),[n,e]),z=(0,o.useCallback)(((e,n,t,r)=>{const o={code:n,message:t};s.v.error(t),V(o),P(n),K(e,{error:o},r)}),[K,P]),x=(0,o.useCallback)(((e,n)=>e?!!E.includes(e)||(z(e,l._m.INVALID_PROVIDER,`Invalid social provider. Valid providers are: ${E.join(", ")}`,{raiseAuthFailure:"signin"===n}),!1):(z(e,l._m.NO_PROVIDER,"Provider is required",{raiseAuthFailure:"signin"===n}),!1)),[z]),$=(0,o.useCallback)(((n,t)=>(0,r.s)(void 0,void 0,void 0,(function*(){try{if(!(yield t()))return void z(n,l._m.VERIFICATION_ERROR,`Failed to link social account: ${n}`,{raiseAuthFailure:!1});null==e||e()}catch(e){e instanceof a.tN&&z(n,l._m.ACCOUNT_ALREADY_LINKED_TO_DIFFERENT_PROFILE,`Social account already linked to a different profile: ${n}`,{raiseAuthFailure:!1})}}))),[z,e]),q=(0,o.useCallback)(((n,t)=>(0,r.s)(void 0,void 0,void 0,(function*(){yield U({onError:()=>z(n,l._m.SIGNIN_ERROR,`Failed to sign-in with social account: ${n}`,{raiseAuthFailure:!0}),onSettled:e,options:{provider:n},verifyFunction:()=>t()})}))),[z,U,e]),J=(0,o.useCallback)((e=>(0,r.s)(void 0,[e],void 0,(function*({authMode:e,provider:n,state:t,authCode:r,captchaToken:o,verifier:l,telegramAuthToken:a,forceCreateUser:d=!1}){try{let s;if(D()){const e=yield W();s=e.publicKey}if("signin"===e){if(n===i.bph.Telegram&&a){const e=()=>(0,p.mU)(I,{forceCreateUser:d,sessionPublicKey:s,telegramAuthToken:a});return yield q(n,e)}if(n===i.bph.Telegram){const e=()=>(0,p.mU)(I,{code:r,sessionPublicKey:s,state:t});yield q(n,e)}else{const e=()=>(0,p.Mm)(I,n,{captchaToken:o,code:r,codeVerifier:l,sessionPublicKey:s,state:t});yield q(n,e)}}else if(n===i.bph.Telegram){const e=()=>(0,p.Dm)(I,{code:r,state:t});yield $(n,e)}else{const e=()=>(0,p.tn)(I,n,{code:r,codeVerifier:l,state:t});yield $(n,e)}}catch(t){s.v.error("Social connection failed with unexpected error:",t),K(n,{error:t},{raiseAuthFailure:"signin"===e})}}))),[I,W,$,K,D,q]),G=(0,o.useCallback)(((e,n)=>(0,r.s)(void 0,[e,n],void 0,(function*(e,{captchaToken:n,redirectUrl:o}){let c;try{c=(0,y.me)()}catch(n){return void z(i.bph.Farcaster,l._m.GENERAL_ERROR,"Missing nonce",{raiseAuthFailure:"signin"===e})}const u=a.fP.getHost(),v=yield(h={domain:u,nonce:c,redirectUrl:o||O,siweUri:a.fP.getOrigin()},(0,r.s)(void 0,void 0,void 0,(function*(){try{const e=yield a.M6.fetch("https://relay.farcaster.xyz/v1/channel",{body:JSON.stringify(h),headers:{"Content-Type":"application/json"},method:"POST"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return yield e.json()}catch(e){return void s.v.error("Error connecting with farcaster:",e)}})));var h;if(!(null==v?void 0:v.url)||!(null==v?void 0:v.channelToken))return void z(i.bph.Farcaster,l._m.GENERAL_ERROR,"Farcaster didn't return a valid url.",{raiseAuthFailure:"signin"===e});(0,a.Fr)()?yield a.fP.openURL(v.url):(F(!0),null==t||t(v.url));const f=yield((e,...n)=>(0,r.s)(void 0,[e,...n],void 0,(function*(e,{timeout:n=3e5,interval:t=1e3}={}){const r=Date.now()+n;let o,i=!0;d.zm.on("farcasterConnectCancelled",(()=>{i=!1,null==o||o(),o=void 0}));const l=e=>{o=e,setTimeout(e,t)};for(;i&&Date.now()<r;){const n=yield b(e);if(!n)return"rejected";if("completed"===n.state)return n;yield new Promise(l)}return i?(s.v.error("Polling farcaster connect status timed out after 300000ms"),"timeout"):"cancelled"})))({channelToken:v.channelToken});if("cancelled"===f)return void M(!1);if(!("timeout"!==f&&"rejected"!==f&&(null==f?void 0:f.message)&&(null==f?void 0:f.custody)&&(null==f?void 0:f.signature)&&(null==f?void 0:f.nonce)))return void z(i.bph.Farcaster,l._m.GENERAL_ERROR,"Farcaster didn't return valid data.",{raiseAuthFailure:"signin"===e});const{custody:m,message:g,signature:k,nonce:C}=f;if("signin"===e){let e;if(D()){const n=yield W();e=n.publicKey}const t=()=>(0,p.Qj)(I,{address:m,captchaToken:n,domain:u,message:g,nonce:C,sessionPublicKey:e,signature:k});yield q(i.bph.Farcaster,t)}else{const e=()=>(0,p.pj)({environmentId:I,farcasterSignInRequest:{address:m,captchaToken:n,domain:u,message:g,nonce:C,signature:k}});yield $(i.bph.Farcaster,e),F(!1,{clearErrors:!1})}M(!1)}))),[O,I,W,z,$,t,F,D,q]),H=(0,o.useCallback)((n=>(0,r.s)(void 0,[n],void 0,(function*({authMode:n,provider:t,validator:r,captchaToken:o,redirectUrl:c,telegramAuthToken:y}){var k,C;if(B(),M(!0),!n)return void s.v.error('Auth mode is required. Please use either "link" or "signin"');if(!x(t,n))return;if(r&&!r(t))return;if(d.zm.emit("authInit",{option:t,provider:t,type:"social"}),t===i.bph.Farcaster)return G(n,{captchaToken:o,redirectUrl:c});const b=(0,g.D)(32),w=(0,g.D)(43),E=A.includes(t);(0,f.us)(t,{captchaToken:o,codeVerifier:E?w:void 0,mode:n,state:b});const F=(0,h.w)(null!==(k=null==N?void 0:N.providers)&&void 0!==k?k:[],t);if(!F)return void z(t,l._m.NO_OAUTH_URL,`Failed to get login url to connect social account: ${t}`,{raiseAuthFailure:"signin"===n});const S=new URL(F);if(S.searchParams.set("state",b),E){const e=yield(0,u.u)(w);S.searchParams.set("code_challenge",(0,v.v)(e)),S.searchParams.set("code_challenge_method","S256")}const P=(0,a.Fr)();try{const r=yield a.Lj.getOauthCode({apiProvider:(0,m.h)(null!==(C=null==N?void 0:N.providers)&&void 0!==C?C:[],t),getOAuthResultFromApi:()=>(0,p.TW)(I,t,{state:b}),initWebAuth:({redirectUrl:e}={})=>(0,p.Ld)(I,t,{redirectUrl:e?R(e):void 0,state:b}),isMobile:P,oauthLoginUrl:S,onSettled:e,provider:t,redirectUrl:null!=c?c:O,setIsProcessing:M,state:b,strategy:T});yield J({authCode:r,authMode:n,captchaToken:o,provider:t,state:b,telegramAuthToken:y,verifier:w})}catch(e){if(a.Lj.isGetOauthCodeError(e))return void z(t,e.code,e.message,{raiseAuthFailure:"signin"===n});s.v.error("Social connection failed with unexpected error:",e.message,e),K(t,{error:e},{raiseAuthFailure:"signin"===n})}}))),[x,B,J,G,O,I,z,K,e,null==N?void 0:N.providers,T]);return(0,o.useMemo)((()=>({checkValidProvider:x,completeConnection:J,connectSocialAccount:H,error:j,handleError:z,isProcessing:L,setError:V,setIsProcessing:M})),[x,J,H,j,z,L])},R=e=>{const n=new URL(e);return n.searchParams.delete("dynamicOauthState"),n.searchParams.delete("dynamicOauthCode"),n.toString()}},96696:(e,n,t)=>{t.d(n,{y:()=>d});var r,o=t(29109),i=t(96540),l=t(46759),a=(t(83650),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(18003)),s=(t(20433),t(83073),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));!function(e){e[e.CHECK_FAILED=0]="CHECK_FAILED"}(r||(r={}));const d=()=>{const{environmentId:e}=(0,s.J)();return(0,i.useCallback)((n=>(0,o.s)(void 0,[n],void 0,(function*({subdomain:n}){var t;const o=yield(0,a.bu)({environmentId:e,filter:{field:l.A$9.NameServiceSubdomainHandle,value:n}});return o?{available:null!==(t=null==o?void 0:o.available)&&void 0!==t&&t,error:void 0}:{available:!1,error:r.CHECK_FAILED}}))),[e])}},248:(e,n,t)=>{t(29109),t(96540),t(22130),t(83650),t(41253)},62316:(e,n,t)=>{t.d(n,{r:()=>d});var r=t(29109),o=t(96540),i=t(80066),l=(t(83650),t(46759),t(69648),t(88393),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(12174),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055)),a=(t(28765),t(40961),t(20545),t(50574),t(75988)),s=(t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const d=()=>{const{setPrimaryWallet:e,user:n,primaryWallet:t}=(0,s.J)(),{getEOAWallet:d}=(0,a.R)(),c=(0,l.zy)();return(0,o.useCallback)((o=>(0,r.s)(void 0,void 0,void 0,(function*(){var r,l,a;const s=c.find((e=>e.id===o));if(!s)throw new Error(`Wallet with id ${o} not found`);if(!s.connector.isAvailable)throw new Error("Cannot make this wallet active, since this wallet doesn't have a compatible connector on this device.");const u=d(s);if(u&&(0,i.NN)(u.connector)){const e=null===(l=null===(r=u.connector)||void 0===r?void 0:r.verifiedCredentials)||void 0===l?void 0:l.reduce(((e,n)=>n.address===u.address?[n,...e]:[...e,n]),[]);e&&u.connector.setVerifiedCredentials(e)}const{connector:v}=s,h=null===(a=null==n?void 0:n.verifiedCredentials.find((e=>"email"===e.format)))||void 0===a?void 0:a.email;(0,i.VC)(v)&&h&&v.setEmail(h),"flow"===(null==t?void 0:t.chain)&&"FLOW"===v.connectedChain&&(yield v.endSession()),e(o)}))),[d,null==t?void 0:t.chain,e,null==n?void 0:n.verifiedCredentials,c])}},26048:(e,n,t)=>{t.d(n,{E:()=>y});var r=t(29109),o=t(96540),i=t(60445),l=t(15047),a=(t(46759),t(80066),t(83650),t(69648)),s=(t(88393),t(74848),t(41253),t(95821),t(3418),t(48702),t(10941),t(6916)),d=(t(16219),t(3194)),c=(t(54769),t(60337),t(86713)),u=(t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(12174),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085)),v=(t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(87237)),h=(t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(40632)),f=(t(18983),t(21858),t(80622),t(31825),t(89809));t(80607);let m=!1;const y=()=>{const{projectSettings:e,user:n,primaryWalletId:t,walletConnectorOptions:y,primaryWallet:g,setShowAuthFlow:p}=(0,f.J)(),{isLoadingEmbeddedWallet:k}=(0,v.u2)(),{loading:C}=(0,u.nk)(),{initExportProcess:b}=(0,h.H)(),[w,E]=(0,s.M)(`dynamic_export_prompt-${null==n?void 0:n.userId}`,!1,(e=>Boolean(e))),{createEmbeddedWallet:A,shouldAutoCreateEmbeddedWallet:I,shouldPromptForKeyExport:R}=(0,l.L)(),F=(0,o.useRef)(!1),S=(0,o.useCallback)(((e=!0)=>{m=e,E(e)}),[E]);return(0,d.h)("logout",(()=>{F.current=!1,m=!1})),(0,o.useEffect)((()=>{const t=I()&&!F.current;w&&!m&&(m=!0);const o=R()&&!m;(t||o)&&n&&e&&y.length&&!k&&!C&&(0,r.s)(void 0,void 0,void 0,(function*(){const e=null==n?void 0:n.newUser;if(t){F.current=!0;try{yield A()}catch(e){e instanceof i.r0?a.v.debug("Error creating embedded wallet",e):a.v.error("Error creating embedded wallet",e),p(!1)}}if(o&&e&&(0,c.v)(n)&&g)try{p(!0),yield b(!0,!0)}catch(e){a.v.error("Error initializing embedded wallet export",e),p(!1)}}))}),[n,e,t,A,k,y,C,I,p,b,g,R,E,S,w]),{acknowledgedExportPrompt:m,handleAcknowledgeExportPrompt:S}}},93850:(e,n,t)=>{t.d(n,{T:()=>d});var r=t(96540),o=(t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253)),i=(t(95821),t(60445),t(3418),t(48702),t(91845)),l=(t(10941),t(16219),t(3194)),a=(t(29109),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(12174),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(92408)),s=(t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const d=({handler:e}={})=>{const{setShowAuthFlow:n,userWithMissingInfo:t,sdkHasLoaded:d}=(0,s.J)(),{setView:c}=(0,o.At)(),{getUserDevices:u}=(0,a.o)(),v=(0,r.useRef)(!1);(0,l.h)("logout",(()=>{v.current=!1})),(0,r.useEffect)((()=>{var r;if(d&&!v.current&&t&&(0,i._)(t)){if(v.current=!0,e)return n(!1),void e();n(!0),(null===(r=t.scope)||void 0===r?void 0:r.includes("requiresAdditionalAuth"))?u().then((e=>{0===e.length?c("mfa-choose-device"):c("mfa-verification")})):c("mfa-display-backup-codes")}}),[u,d,n,c,t,e])}},16376:(e,n,t)=>{t.d(n,{s:()=>f});var r=t(29109),o=t(96540),i=t(46759),l=t(3194),a=(t(83650),t(69648)),s=(t(88393),t(80066),t(74848),t(41253)),d=(t(95821),t(60445),t(3418),t(48702),t(91845)),c=(t(10941),t(16219),t(54769),t(60337),t(4402),t(11011),t(40337),t(81285),t(45468),t(99157),t(7116),t(20433),t(83073),t(21029),t(47979),t(63055),t(12174),t(28765)),u=(t(40961),t(20545),t(50574),t(451),t(30593),t(68248)),v=(t(6864),t(29147),t(72366),t(14170)),h=(t(65381),t(55537),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(87237),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(7085),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(80607),t(18983),t(21858),t(80622),t(31825),t(89809));const f=({handler:e}={})=>{const{setShowAuthFlow:n,userWithMissingInfo:t,sdkHasLoaded:f,setSelectedWalletConnectorKey:m}=(0,h.J)(),{setView:y}=(0,s.At)(),{updateUser:g}=(0,v.U)({validationSchemaStripUnknown:!1}),{completeAuth:p,handleAuthError:k}=(0,u.r)({}),{displayedDestination:C}=(0,c.vm)(),b=(0,o.useRef)(!1);(0,l.h)("logout",(()=>{b.current=!1})),(0,o.useEffect)((()=>{var o;f&&!b.current&&(null===(o=null==t?void 0:t.missingFields)||void 0===o?void 0:o.length)&&!(0,d._)(t)&&(e?(0,r.s)(void 0,void 0,void 0,(function*(){var n;if(e&&(null===(n=null==t?void 0:t.missingFields)||void 0===n?void 0:n.length)){b.current=!0;try{const n=t.missingFields.map((e=>({isCustom:"custom"===e.type,key:e.name,label:e.label,required:e.required}))),o=yield e(n),i={},l=Object.assign({},null==t?void 0:t.metadata);o.forEach((e=>{e.isCustom?l[e.key]=e.value:i[e.key]=e.value})),yield p({updateJwtFunction:()=>(0,r.s)(void 0,void 0,void 0,(function*(){return g(Object.assign(Object.assign({},i),{metadata:l}))}))})}catch(e){a.v.error("Error handling user onboarding",e),k(e,{})}}})):(0,r.s)(void 0,void 0,void 0,(function*(){b.current=!0,n(!0);const e=null==t?void 0:t.verifiedCredentials.find((e=>e.id===(null==t?void 0:t.lastVerifiedCredentialId)));switch((null==e?void 0:e.walletName)&&m(null==e?void 0:e.walletName),null==e?void 0:e.format){case i.z3W.Email:case i.z3W.Oauth:y("collect-user-data-login-no-wallet",{userIdentification:"email"});break;case i.z3W.PhoneNumber:y("collect-user-data-login-no-wallet",{userIdentification:"phoneNumber",userIdentificationOverride:C});break;default:y("collect-user-data")}})))}),[f,t,e,p,g,n,y,C,k,m])}},77796:(e,n,t)=>{t(29109),t(46759),t(48702),t(60445),t(4402),t(69648),t(3418),t(11011),t(88393),t(80066),t(96540),t(74848),t(41253),t(95821),t(10941),t(16219),t(40337),t(89741),t(81285),t(45468),t(99157),t(279),t(7116),t(20433),t(83073),t(83650),t(12174),t(54769),t(60337),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(65050),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(87237),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(7085),t(78080),t(80607),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809)},16130:(e,n,t)=>{t.d(n,{Z:()=>i});var r=t(96540),o=t(67416);const i=(e,n)=>{const t=(0,r.useRef)(e);(0,o.E)((()=>{t.current=e}),[e]),(0,r.useEffect)((()=>{if(!n&&0!==n)return;const e=setTimeout((()=>t.current()),n);return()=>clearTimeout(e)}),[n])}},15700:(e,n,t)=>{t.d(n,{m:()=>h});var r=t(29109),o=t(96540),i=t(46759),l=t(80622),a=t(80446),s=(t(83650),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(60445),t(3418),t(48702),t(10941),t(16219),t(3194)),d=(t(54769),t(60337),t(83219)),c=(t(4402),t(11011),t(40337),t(81285),t(45468),t(69553)),u=(t(99157),t(7116),t(20433)),v=(t(83073),t(21029),t(47979),t(63055),t(12174),t(28765),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(31825),t(89809));const h=({accountAddress:e,networkId:n,chainName:t=i.lVq.Evm,tokenAddresses:h,includeFiat:f=!1,includeNativeBalance:m=!1}={})=>{const y=(0,l.HZ)(),{tokenBalances:g,isLoading:p,error:k}=y,{primaryWallet:C,environmentId:b,network:w,user:E,projectSettings:A,authMode:I}=(0,v.J)(),R=null==C?void 0:C.connector,F=null!=t?t:null==R?void 0:R.connectedChain,S=null!=e?e:null==C?void 0:C.address,N=null!=n?n:w,O=(0,o.useCallback)(((...e)=>(0,r.s)(void 0,[...e],void 0,(function*(e=!1){var n;if("connect-only"!==I&&!E)return void(0,l.W_)("error",d.nM);if("connect-only"===I&&!(null===(n=null==A?void 0:A.sdk.featureFlags)||void 0===n?void 0:n.connectOnlyMultiAsset))return;if(![i.lVq.Evm,i.lVq.Sol].includes(F))return void(0,l.W_)("error",`Chain ${F} is not supported for token balances`);const r=t===i.lVq.Evm&&N&&Object.values(i.xVy).includes(N)||t===i.lVq.Sol;if(!p&&S&&r){(0,l.W_)("isLoading",!0);try{const n=yield(0,a.C)({accountAddress:S,chainName:F,environmentId:b,forceRefresh:e,includeNative:m,includePrices:f,networkId:t===i.lVq.Evm?Number(N):0});if(!n)return;(0,l.W_)("error",void 0),(0,l.W_)("tokenBalances",n)}catch(e){yield(0,c.y)(e,"Error getting token balances");const n=429===(null==e?void 0:e.code)?"Too many requests fetching balances":null==e?void 0:e.message;(0,l.W_)("error",n)}finally{(0,l.W_)("isLoading",!1)}}else(0,l.W_)("tokenBalances",void 0)}))),[E,F,t,N,p,S,b,m,f]);(0,s.h)("tokenBalancesChanged",(()=>O(!0))),(0,o.useEffect)((()=>{O()}),[S,N]);const{tokensFilter:T}=(0,u.kL)(),P=null==h?void 0:h.map((e=>e.toLowerCase())),_=P?null==g?void 0:g.filter((e=>null==P?void 0:P.includes(e.address.toLowerCase()))):g,U=_?T(_):[];return{error:k,fetchAccountBalances:O,isError:Boolean(k),isLoading:p,tokenBalances:U}}},80396:(e,n,t)=>{t.d(n,{i:()=>h});var r=t(29109),o=t(96540),i=t(60445),l=(t(83650),t(46759),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(3418),t(48702),t(10941),t(16219),t(12174),t(54769),t(60337),t(83219)),a=(t(4402),t(11011),t(79622)),s=(t(81285),t(45468),t(99157),t(7116),t(52331)),d=t(81149),c=(t(21029),t(47979),t(63055)),u=t(90745),v=(t(28765),t(40337),t(40961),t(20545),t(50574),t(451),t(30593),t(7085),t(87237),t(83073),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(20433),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809));const h=()=>{const{displaySiweStatement:e,environmentId:n,user:t,primaryWallet:h}=(0,v.J)(),{addedWalletsIds:f}=(0,c.i0)(),m=(0,o.useCallback)(((e,n)=>{const t=e.key;if(n.lastVerifiedCredentialId){if(!h)return void(0,d.q)(n.lastVerifiedCredentialId);t===h.connector.key&&(0,d.q)(n.lastVerifiedCredentialId),"FLOW"===h.connector.connectedChain&&"FLOW"===e.connectedChain&&(0,d.q)(n.lastVerifiedCredentialId)}}),[h]);return(0,o.useCallback)((o=>(0,r.s)(void 0,void 0,void 0,(function*(){if(!t)throw new i.ii(l.nM);const{overrideSiweStatement:r,walletConnector:d}=o,c=Object.assign(Object.assign({},o),{displaySiweStatement:e,environmentId:n,siweStatement:r,walletProvider:(0,u.z)(d)}),v=yield(0,a.d)(c),h=yield(0,s.bU)(n,v);if(!h)throw new i.ii("Error transferring wallet.");m(d,h);const y=h.lastVerifiedCredentialId;y&&f.current.push(y)}))),[f,e,n,m,t])}},32505:(e,n,t)=>{t.d(n,{p:()=>d});var r=t(29109),o=t(96540),i=t(58241),l=t(280);const a=(e,n)=>{const t={ENTERED:null==n?void 0:n.onEntered,ENTERING:null==n?void 0:n.onEntering,EXITING:null==n?void 0:n.onExiting,UNMOUNT:null==n?void 0:n.onUnmount};return((n,r)=>{const i=(0,l.m)();(0,o.useEffect)((()=>{if(!i)return null===(n=t[e])||void 0===n||n.call(t),()=>{var n;"EXITING"===e&&(null===(n=t.UNMOUNT)||void 0===n||n.call(t))};var n}),r)})(0,[e])},s=100,d=e=>{var{isShown:n,inDuration:t,outDuration:l,duration:d=s,delay:c,inDelay:u,outDelay:v,animateOnMount:h=!0}=e,f=(0,r.T)(e,["isShown","inDuration","outDuration","duration","delay","inDelay","outDelay","animateOnMount"]);const m=h?"UNMOUNT":"ENTERED",y=(0,o.useRef)({id:-1}),g=(0,o.useRef)({id:-1}),[p,k]=(0,o.useState)(m),[C,b]=(0,o.useState)(!h),[w,E]=(0,o.useState)(d),A=(e,n)=>{n?g.current=(0,i.V)(e,n):e()},I=(0,o.useCallback)((()=>{const e=t||d;E(e),b(!0),k("ENTERING"),y.current=(0,i.V)((()=>{k("ENTERED")}),e)}),[d,t]),R=(0,o.useCallback)((()=>{const e=l||d;E(e),k("EXITING"),y.current=(0,i.V)((()=>{b(!1),k("UNMOUNT")}),e)}),[d,l]);return(0,o.useEffect)((()=>(n&&"ENTERED"!==p?A(I,u||c):n||"UNMOUNT"===p||A(R,v||c),()=>{(0,i.u)(y.current),(0,i.u)(g.current)})),[u,v,I,R,n,c,p]),a(p,f),{currentDuration:w,mount:C,stage:p}}},28578:(e,n,t)=>{t(29109),t(96540),t(60445),t(46759),t(83650),t(69648),t(88393),t(80066),t(74848),t(41253),t(95821),t(3418),t(48702),t(10941),t(16219),t(12174),t(54769),t(60337),t(86713),t(4402),t(11011),t(40337),t(81285),t(45468),t(12707),t(99157),t(7116),t(52331),t(81149),t(21029),t(47979),t(63055),t(28765),t(40961),t(20545),t(11823),t(30447),t(50574),t(451),t(30593),t(7085),t(87237),t(83073),t(80607),t(6864),t(29147),t(72366),t(55537),t(65381),t(75705),t(20433),t(27373),t(95081),t(100),t(58080),t(53006),t(11012),t(71172),t(14624),t(44432),t(79903),t(53454),t(74566),t(85168),t(71092),t(26968),t(56950),t(43433),t(87583),t(30261),t(96696),t(58169),t(23121),t(4623),t(22923),t(44917),t(94734),t(26490),t(10647),t(78080),t(95253),t(44719),t(79620),t(59553),t(31448),t(98592),t(18983),t(21858),t(80622),t(31825),t(89809)}}]);